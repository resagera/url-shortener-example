# url-shortener-example

тестовое задание: Высокопроизводительный сокращатель ссылок (High-Performance URL Shortener)

## Стек
 - Golang
 - встроенная база данных (например, SQLite или in-memory Key-Value store)
 - стандартные библиотеки Go.

## Цель задания
> Создать минималистичный, но высокопроизводительный сервис для сокращения URL-адресов. Основной акцент делается на качестве кода, эффективности обработки запросов, дизайне API и параллельной обработке.

## Функциональные требования
Сервис должен предоставлять HTTP API с двумя основными эндпоинтами (конечными точками):

### 1. Создание сокращенного URL (Shorten Endpoint)
**Метод**: ```POST```

**Путь**: ```/api/v1/shorten```

**Тело запроса** (JSON):
```{"url": "https://very-long-original-url.com/some/path?param=value"}```

**Генерация ключа:** _Создать уникальный, короткий (например, 7-10 символов) ключ (идентификатор)._

Важно: Не исходите из того, что простой инкрементальный счетчик является лучшим решением. Продемонстрируйте понимание того, как генерировать уникальные ID в многопоточной среде.

Тело ответа (JSON - HTTP 201 Created):
```{"short_url": "http://localhost:8080/xyz123abc"}```

Примечание: URL-адрес должен быть полным, включая домен и порт сервиса.

### 2. Перенаправление (Redirect Endpoint)
   Метод: ```GET```

Путь: ```/{short_key}``` (например, /xyz123abc)

Логика:
1. Извлечь short_key из пути.
2. Найти оригинальный URL-адрес в хранилище по этому ключу.
3. Выполнить HTTP 301 Permanent Redirect на оригинальный URL-адрес.
4. Обработка ошибок: Если ключ не найден, вернуть ответ HTTP 404 Not Found.

## Технические требования и критерии оценки

1. Дизайн и архитектура (Design & Architecture)
2. Многопоточность и конкурентность (Concurrency & Performance)
3. Обработка ошибок и валидация (Error Handling & Validation)

### Тесты:

Выполнение основного задания:
```go test ./internal/web -run TestShortenAndRedirect -v```

Бенчмарк на генгерацию ИД:
```go test ./internal/service/shortener -bench=. -benchmem -run=^$```


Нагрузочный тест (проверка хранилища в памяти и в SQLite:
```go test ./internal/web -run TestShortener_Load -v```

Задание не использует библиотек кроме стандартных, если брать БД в памяти

### Рекомендации:
ИД можно генерировать заранее в большом количестве и выдавать сразу ответ, до реальной записи в БД (записывать в логи, если будут проблемы с БД, данные можно будет восстановить) - увеличит скорость создания
шардировать сервисы и добавить в ИД ссылки ИД сервиса, чтобы уникальные коды не пересекались

